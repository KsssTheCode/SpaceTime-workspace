<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="memberMapper">
	
	<!-- MEMBER 테이블로부터 조회된 내용을 Member 타입으로 가공해주는 ResultMap -->
	<resultMap id="memberResultSet" type="member">
		<result column="MEM_NO" property="memNo" />
		<result column="MEM_ID" property="memId" />
		<result column="MEM_PWD" property="memPwd" />
		<result column="MEM_NAME" property="memName" />
		<result column="GENDER" property="gender" />
		<result column="BIRTHDAY" property="birthday" />
		<result column="NICKNAME" property="nickname" />
		<result column="PHONE" property="phone" />
		<result column="EMAIL" property="email" />
		<result column="PROFILE_PATH" property="profilePath" />
		<result column="ENROLL_DATE" property="enrollDate" />
		<result column="HOST_STATUS" property="hostStatus" />
		<result column="BANK_NAME" property="bankName" />
		<result column="ACCOUNT_NUM" property="accountNum" />
		<result column="BLACKLIST_YN" property="blacklist" />
		<result column="BLACKLIST_REASON" property="blacklistReason" />
		<result column="MEM_STATUS" property="memStatus" />
		<result column="GR_CODE" property="grCode" />
	</resultMap>

	<!-- 로그인용 쿼리문 - 경미 -->
	<select id="loginMember" parameterType="member" resultMap="memberResultSet">
		SELECT *
		FROM MEMBER
		WHERE MEM_ID = #{memId}
		  AND MEM_STATUS = 'N'
	</select>
	
	<!-- 회원가입용 쿼리문 - 경미 -->
	<insert id="insertMember" parameterType="member">
		INSERT INTO MEMBER (MEM_NO
						  , MEM_ID
						  , MEM_PWD
						  , MEM_NAME
						  , GENDER
						  , BIRTHDAY
						  , NICKNAME
						  , PHONE
						  , EMAIL)
					VALUES (SEQ_MNO.NEXTVAL
						  , #{memId}
						  , #{memPwd}
						  , #{memName}
						  , #{gender}
						  , TO_DATE(#{birthday}, 'YYYYMMDD')
						  , #{nickname}
						  , #{phone}
						  , #{email})
	</insert>
	
	<update id="updateMember" parameterType="member">
		UPDATE MEMBER
		   SET MEM_NAME = #{memName}
		     , EMAIL = #{email}
		     , PHONE = #{phone}
		 WHERE MEM_NO = #{memNo}
	</update>
	
	<!-- 회원 탈퇴용 쿼리문 - 경미 -->
	<update id="deleteMember" parameterType="_int">
		UPDATE MEMBER
		   SET MEM_STATUS = 'Y'
		 WHERE MEM_NO = #{memNo}
	</update>
	
	<!-- 아이디 중복체크 쿼리문 - 경미 -->
	<select id="idCheck" parameterType="string" resultType="_int">
		SELECT COUNT(*)
		FROM MEMBER
		WHERE MEM_ID = #{checkId}
	</select>
	
	<!-- 닉네임 중복체크 쿼리문 - 경미 -->
	<select id="nickCheck" parameterType="string" resultType="_int">
		SELECT COUNT(*)
		FROM MEMBER
		WHERE NICKNAME = #{checkNick}
	</select>
</mapper>
